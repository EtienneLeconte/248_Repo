{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Pipelines"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: quandl in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (3.5.2)\n",
      "Requirement already satisfied: requests>=2.7.0 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (2.24.0)\n",
      "Requirement already satisfied: python-dateutil in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (2.8.1)\n",
      "Requirement already satisfied: pandas>=0.14 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (1.1.1)\n",
      "Requirement already satisfied: six in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (1.15.0)\n",
      "Requirement already satisfied: inflection>=0.3.1 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (0.5.1)\n",
      "Requirement already satisfied: more-itertools in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (8.5.0)\n",
      "Requirement already satisfied: numpy>=1.8 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from quandl) (1.19.1)\n",
      "Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from requests>=2.7.0->quandl) (3.0.4)\n",
      "Requirement already satisfied: idna<3,>=2.5 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from requests>=2.7.0->quandl) (2.10)\n",
      "Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from requests>=2.7.0->quandl) (1.25.9)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from requests>=2.7.0->quandl) (2020.6.20)\n",
      "Requirement already satisfied: pytz>=2017.2 in /usr/local/Cellar/jupyterlab/2.2.0/libexec/lib/python3.8/site-packages (from pandas>=0.14->quandl) (2020.1)\n",
      "\u001b[33mWARNING: You are using pip version 20.1.1; however, version 20.2.3 is available.\n",
      "You should consider upgrading via the '/usr/local/Cellar/jupyterlab/2.2.0/libexec/bin/python3.8 -m pip install --upgrade pip' command.\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install quandl"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import quandl"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "import getpass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "········\n"
     ]
    }
   ],
   "source": [
    "quandl.ApiConfig.api_key=getpass.getpass()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "companies=pd.read_csv('https://s3-eu-west-1.amazonaws.com/ih-materials/uploads/data-static/data/module-1/companies.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Ticker</th>\n",
       "      <th>Company</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AAPL</td>\n",
       "      <td>Apple Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NFLX</td>\n",
       "      <td>Netflix, Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AMZN</td>\n",
       "      <td>Amazon.com, Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MSFT</td>\n",
       "      <td>Microsoft Corporation</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>GOOG</td>\n",
       "      <td>Alphabet Inc.</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Ticker                Company\n",
       "0   AAPL             Apple Inc.\n",
       "1   NFLX          Netflix, Inc.\n",
       "2   AMZN       Amazon.com, Inc.\n",
       "3   MSFT  Microsoft Corporation\n",
       "4   GOOG          Alphabet Inc."
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "companies.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(30, 2)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "companies.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "ticker_list=companies.Ticker.to_list()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "retrieving data for AAPL\n"
     ]
    }
   ],
   "source": [
    "print('retrieving data for',ticker_list[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "prices=quandl.get('WIKI/'+ticker_list[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>Ex-Dividend</th>\n",
       "      <th>Split Ratio</th>\n",
       "      <th>Adj. Open</th>\n",
       "      <th>Adj. High</th>\n",
       "      <th>Adj. Low</th>\n",
       "      <th>Adj. Close</th>\n",
       "      <th>Adj. Volume</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1980-12-12</th>\n",
       "      <td>28.75</td>\n",
       "      <td>28.87</td>\n",
       "      <td>28.75</td>\n",
       "      <td>28.750</td>\n",
       "      <td>2093900.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.422706</td>\n",
       "      <td>0.424470</td>\n",
       "      <td>0.422706</td>\n",
       "      <td>0.422706</td>\n",
       "      <td>117258400.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1980-12-15</th>\n",
       "      <td>27.38</td>\n",
       "      <td>27.38</td>\n",
       "      <td>27.25</td>\n",
       "      <td>27.250</td>\n",
       "      <td>785200.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.402563</td>\n",
       "      <td>0.402563</td>\n",
       "      <td>0.400652</td>\n",
       "      <td>0.400652</td>\n",
       "      <td>43971200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1980-12-16</th>\n",
       "      <td>25.37</td>\n",
       "      <td>25.37</td>\n",
       "      <td>25.25</td>\n",
       "      <td>25.250</td>\n",
       "      <td>472000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.373010</td>\n",
       "      <td>0.373010</td>\n",
       "      <td>0.371246</td>\n",
       "      <td>0.371246</td>\n",
       "      <td>26432000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1980-12-17</th>\n",
       "      <td>25.87</td>\n",
       "      <td>26.00</td>\n",
       "      <td>25.87</td>\n",
       "      <td>25.870</td>\n",
       "      <td>385900.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.380362</td>\n",
       "      <td>0.382273</td>\n",
       "      <td>0.380362</td>\n",
       "      <td>0.380362</td>\n",
       "      <td>21610400.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1980-12-18</th>\n",
       "      <td>26.63</td>\n",
       "      <td>26.75</td>\n",
       "      <td>26.63</td>\n",
       "      <td>26.630</td>\n",
       "      <td>327900.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.391536</td>\n",
       "      <td>0.393300</td>\n",
       "      <td>0.391536</td>\n",
       "      <td>0.391536</td>\n",
       "      <td>18362400.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-21</th>\n",
       "      <td>175.04</td>\n",
       "      <td>175.09</td>\n",
       "      <td>171.26</td>\n",
       "      <td>171.270</td>\n",
       "      <td>35247358.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>175.040000</td>\n",
       "      <td>175.090000</td>\n",
       "      <td>171.260000</td>\n",
       "      <td>171.270000</td>\n",
       "      <td>35247358.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-22</th>\n",
       "      <td>170.00</td>\n",
       "      <td>172.68</td>\n",
       "      <td>168.60</td>\n",
       "      <td>168.845</td>\n",
       "      <td>41051076.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>170.000000</td>\n",
       "      <td>172.680000</td>\n",
       "      <td>168.600000</td>\n",
       "      <td>168.845000</td>\n",
       "      <td>41051076.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-23</th>\n",
       "      <td>168.39</td>\n",
       "      <td>169.92</td>\n",
       "      <td>164.94</td>\n",
       "      <td>164.940</td>\n",
       "      <td>40248954.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>168.390000</td>\n",
       "      <td>169.920000</td>\n",
       "      <td>164.940000</td>\n",
       "      <td>164.940000</td>\n",
       "      <td>40248954.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-26</th>\n",
       "      <td>168.07</td>\n",
       "      <td>173.10</td>\n",
       "      <td>166.44</td>\n",
       "      <td>172.770</td>\n",
       "      <td>36272617.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>168.070000</td>\n",
       "      <td>173.100000</td>\n",
       "      <td>166.440000</td>\n",
       "      <td>172.770000</td>\n",
       "      <td>36272617.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-27</th>\n",
       "      <td>173.68</td>\n",
       "      <td>175.15</td>\n",
       "      <td>166.92</td>\n",
       "      <td>168.340</td>\n",
       "      <td>38962839.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>173.680000</td>\n",
       "      <td>175.150000</td>\n",
       "      <td>166.920000</td>\n",
       "      <td>168.340000</td>\n",
       "      <td>38962839.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>9400 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              Open    High     Low    Close      Volume  Ex-Dividend  \\\n",
       "Date                                                                   \n",
       "1980-12-12   28.75   28.87   28.75   28.750   2093900.0          0.0   \n",
       "1980-12-15   27.38   27.38   27.25   27.250    785200.0          0.0   \n",
       "1980-12-16   25.37   25.37   25.25   25.250    472000.0          0.0   \n",
       "1980-12-17   25.87   26.00   25.87   25.870    385900.0          0.0   \n",
       "1980-12-18   26.63   26.75   26.63   26.630    327900.0          0.0   \n",
       "...            ...     ...     ...      ...         ...          ...   \n",
       "2018-03-21  175.04  175.09  171.26  171.270  35247358.0          0.0   \n",
       "2018-03-22  170.00  172.68  168.60  168.845  41051076.0          0.0   \n",
       "2018-03-23  168.39  169.92  164.94  164.940  40248954.0          0.0   \n",
       "2018-03-26  168.07  173.10  166.44  172.770  36272617.0          0.0   \n",
       "2018-03-27  173.68  175.15  166.92  168.340  38962839.0          0.0   \n",
       "\n",
       "            Split Ratio   Adj. Open   Adj. High    Adj. Low  Adj. Close  \\\n",
       "Date                                                                      \n",
       "1980-12-12          1.0    0.422706    0.424470    0.422706    0.422706   \n",
       "1980-12-15          1.0    0.402563    0.402563    0.400652    0.400652   \n",
       "1980-12-16          1.0    0.373010    0.373010    0.371246    0.371246   \n",
       "1980-12-17          1.0    0.380362    0.382273    0.380362    0.380362   \n",
       "1980-12-18          1.0    0.391536    0.393300    0.391536    0.391536   \n",
       "...                 ...         ...         ...         ...         ...   \n",
       "2018-03-21          1.0  175.040000  175.090000  171.260000  171.270000   \n",
       "2018-03-22          1.0  170.000000  172.680000  168.600000  168.845000   \n",
       "2018-03-23          1.0  168.390000  169.920000  164.940000  164.940000   \n",
       "2018-03-26          1.0  168.070000  173.100000  166.440000  172.770000   \n",
       "2018-03-27          1.0  173.680000  175.150000  166.920000  168.340000   \n",
       "\n",
       "            Adj. Volume  \n",
       "Date                     \n",
       "1980-12-12  117258400.0  \n",
       "1980-12-15   43971200.0  \n",
       "1980-12-16   26432000.0  \n",
       "1980-12-17   21610400.0  \n",
       "1980-12-18   18362400.0  \n",
       "...                 ...  \n",
       "2018-03-21   35247358.0  \n",
       "2018-03-22   41051076.0  \n",
       "2018-03-23   40248954.0  \n",
       "2018-03-26   36272617.0  \n",
       "2018-03-27   38962839.0  \n",
       "\n",
       "[9400 rows x 12 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "prices=quandl.get('WIKI/'+ticker_list[29])['Adj. Close'].reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "prices['Ticker']=ticker_list[29]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Adj. Close</th>\n",
       "      <th>Ticker</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1991-09-30</td>\n",
       "      <td>10.890339</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1991-10-01</td>\n",
       "      <td>11.211020</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1991-10-02</td>\n",
       "      <td>10.890339</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1991-10-03</td>\n",
       "      <td>11.371361</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1991-10-04</td>\n",
       "      <td>10.890339</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6668</th>\n",
       "      <td>2018-03-21</td>\n",
       "      <td>85.920000</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6669</th>\n",
       "      <td>2018-03-22</td>\n",
       "      <td>84.240000</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6670</th>\n",
       "      <td>2018-03-23</td>\n",
       "      <td>82.900000</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6671</th>\n",
       "      <td>2018-03-26</td>\n",
       "      <td>84.130000</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6672</th>\n",
       "      <td>2018-03-27</td>\n",
       "      <td>83.290000</td>\n",
       "      <td>WM</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6673 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           Date  Adj. Close Ticker\n",
       "0    1991-09-30   10.890339     WM\n",
       "1    1991-10-01   11.211020     WM\n",
       "2    1991-10-02   10.890339     WM\n",
       "3    1991-10-03   11.371361     WM\n",
       "4    1991-10-04   10.890339     WM\n",
       "...         ...         ...    ...\n",
       "6668 2018-03-21   85.920000     WM\n",
       "6669 2018-03-22   84.240000     WM\n",
       "6670 2018-03-23   82.900000     WM\n",
       "6671 2018-03-26   84.130000     WM\n",
       "6672 2018-03-27   83.290000     WM\n",
       "\n",
       "[6673 rows x 3 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_tickers():\n",
    "    companies=pd.read_csv('https://s3-eu-west-1.amazonaws.com/ih-materials/uploads/data-static/data/module-1/companies.csv')\n",
    "    ticker_list=companies.Ticker.to_list()\n",
    "    print('Retrieved',len(ticker_list),'tickers')\n",
    "    return ticker_list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Retrieved 30 tickers\n"
     ]
    }
   ],
   "source": [
    "tickers=get_tickers()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_prices(ticker):\n",
    "    print('Retrieving data for',ticker)\n",
    "    prices=quandl.get('WIKI/'+ticker)['Adj. Close'].reset_index()\n",
    "    prices['Ticker']=ticker\n",
    "    return prices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "def acquisition():\n",
    "    tickers=get_tickers()\n",
    "    data=[get_prices(ticker) for ticker in tickers]\n",
    "    df=pd.concat(data, sort=True)\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Retrieved 30 tickers\n",
      "Retrieving data for AAPL\n",
      "Retrieving data for NFLX\n",
      "Retrieving data for AMZN\n",
      "Retrieving data for MSFT\n",
      "Retrieving data for GOOG\n",
      "Retrieving data for TSLA\n",
      "Retrieving data for FB\n",
      "Retrieving data for AAP\n",
      "Retrieving data for DIS\n",
      "Retrieving data for NKE\n",
      "Retrieving data for UA\n",
      "Retrieving data for BAC\n",
      "Retrieving data for CCL\n",
      "Retrieving data for CI\n",
      "Retrieving data for AAL\n",
      "Retrieving data for LUV\n",
      "Retrieving data for WFC\n",
      "Retrieving data for WMT\n",
      "Retrieving data for HD\n",
      "Retrieving data for ORCL\n",
      "Retrieving data for IBM\n",
      "Retrieving data for NCLH\n",
      "Retrieving data for RCL\n",
      "Retrieving data for TWX\n",
      "Retrieving data for FOX\n",
      "Retrieving data for F\n",
      "Retrieving data for GCI\n",
      "Retrieving data for XOM\n",
      "Retrieving data for WWE\n",
      "Retrieving data for WM\n"
     ]
    }
   ],
   "source": [
    "df=acquisition()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "def concat_pivot(df, rows='Date', columns='Ticker', values='Adj. Close'):\n",
    "    pivot=df.pivot_table(values=values, index=rows, columns=columns)\n",
    "    return pivot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Ticker</th>\n",
       "      <th>AAL</th>\n",
       "      <th>AAP</th>\n",
       "      <th>AAPL</th>\n",
       "      <th>AMZN</th>\n",
       "      <th>BAC</th>\n",
       "      <th>CCL</th>\n",
       "      <th>CI</th>\n",
       "      <th>DIS</th>\n",
       "      <th>F</th>\n",
       "      <th>FB</th>\n",
       "      <th>...</th>\n",
       "      <th>ORCL</th>\n",
       "      <th>RCL</th>\n",
       "      <th>TSLA</th>\n",
       "      <th>TWX</th>\n",
       "      <th>UA</th>\n",
       "      <th>WFC</th>\n",
       "      <th>WM</th>\n",
       "      <th>WMT</th>\n",
       "      <th>WWE</th>\n",
       "      <th>XOM</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1962-01-02</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.141259</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1962-01-03</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.143155</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1962-01-04</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.143155</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1962-01-05</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.143648</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1962-01-08</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.143155</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-21</th>\n",
       "      <td>54.09</td>\n",
       "      <td>115.24</td>\n",
       "      <td>171.270</td>\n",
       "      <td>1581.86</td>\n",
       "      <td>31.87</td>\n",
       "      <td>67.06</td>\n",
       "      <td>167.05</td>\n",
       "      <td>101.820000</td>\n",
       "      <td>11.10</td>\n",
       "      <td>169.39</td>\n",
       "      <td>...</td>\n",
       "      <td>47.02</td>\n",
       "      <td>123.37</td>\n",
       "      <td>316.53</td>\n",
       "      <td>95.29</td>\n",
       "      <td>14.07</td>\n",
       "      <td>54.79</td>\n",
       "      <td>85.92</td>\n",
       "      <td>88.18</td>\n",
       "      <td>36.30</td>\n",
       "      <td>75.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-22</th>\n",
       "      <td>52.31</td>\n",
       "      <td>111.71</td>\n",
       "      <td>168.845</td>\n",
       "      <td>1544.10</td>\n",
       "      <td>30.55</td>\n",
       "      <td>66.20</td>\n",
       "      <td>165.34</td>\n",
       "      <td>100.600000</td>\n",
       "      <td>10.75</td>\n",
       "      <td>164.89</td>\n",
       "      <td>...</td>\n",
       "      <td>45.89</td>\n",
       "      <td>120.18</td>\n",
       "      <td>309.10</td>\n",
       "      <td>94.26</td>\n",
       "      <td>13.71</td>\n",
       "      <td>52.53</td>\n",
       "      <td>84.24</td>\n",
       "      <td>87.14</td>\n",
       "      <td>35.90</td>\n",
       "      <td>73.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-23</th>\n",
       "      <td>51.01</td>\n",
       "      <td>110.84</td>\n",
       "      <td>164.940</td>\n",
       "      <td>1495.56</td>\n",
       "      <td>29.17</td>\n",
       "      <td>64.41</td>\n",
       "      <td>164.00</td>\n",
       "      <td>98.540000</td>\n",
       "      <td>10.56</td>\n",
       "      <td>159.39</td>\n",
       "      <td>...</td>\n",
       "      <td>44.79</td>\n",
       "      <td>117.04</td>\n",
       "      <td>301.54</td>\n",
       "      <td>92.57</td>\n",
       "      <td>13.72</td>\n",
       "      <td>50.98</td>\n",
       "      <td>82.90</td>\n",
       "      <td>85.42</td>\n",
       "      <td>35.82</td>\n",
       "      <td>72.89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-26</th>\n",
       "      <td>51.86</td>\n",
       "      <td>114.77</td>\n",
       "      <td>172.770</td>\n",
       "      <td>1555.86</td>\n",
       "      <td>30.44</td>\n",
       "      <td>65.80</td>\n",
       "      <td>168.68</td>\n",
       "      <td>100.650000</td>\n",
       "      <td>10.83</td>\n",
       "      <td>160.06</td>\n",
       "      <td>...</td>\n",
       "      <td>46.48</td>\n",
       "      <td>119.92</td>\n",
       "      <td>304.18</td>\n",
       "      <td>93.99</td>\n",
       "      <td>14.46</td>\n",
       "      <td>52.29</td>\n",
       "      <td>84.13</td>\n",
       "      <td>87.50</td>\n",
       "      <td>36.90</td>\n",
       "      <td>74.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-03-27</th>\n",
       "      <td>50.90</td>\n",
       "      <td>115.01</td>\n",
       "      <td>168.340</td>\n",
       "      <td>1497.05</td>\n",
       "      <td>29.52</td>\n",
       "      <td>65.73</td>\n",
       "      <td>165.54</td>\n",
       "      <td>99.360000</td>\n",
       "      <td>10.83</td>\n",
       "      <td>152.19</td>\n",
       "      <td>...</td>\n",
       "      <td>45.38</td>\n",
       "      <td>118.30</td>\n",
       "      <td>279.18</td>\n",
       "      <td>94.20</td>\n",
       "      <td>14.32</td>\n",
       "      <td>51.10</td>\n",
       "      <td>83.29</td>\n",
       "      <td>86.05</td>\n",
       "      <td>36.18</td>\n",
       "      <td>73.70</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14156 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Ticker        AAL     AAP     AAPL     AMZN    BAC    CCL      CI         DIS  \\\n",
       "Date                                                                            \n",
       "1962-01-02    NaN     NaN      NaN      NaN    NaN    NaN     NaN    0.141259   \n",
       "1962-01-03    NaN     NaN      NaN      NaN    NaN    NaN     NaN    0.143155   \n",
       "1962-01-04    NaN     NaN      NaN      NaN    NaN    NaN     NaN    0.143155   \n",
       "1962-01-05    NaN     NaN      NaN      NaN    NaN    NaN     NaN    0.143648   \n",
       "1962-01-08    NaN     NaN      NaN      NaN    NaN    NaN     NaN    0.143155   \n",
       "...           ...     ...      ...      ...    ...    ...     ...         ...   \n",
       "2018-03-21  54.09  115.24  171.270  1581.86  31.87  67.06  167.05  101.820000   \n",
       "2018-03-22  52.31  111.71  168.845  1544.10  30.55  66.20  165.34  100.600000   \n",
       "2018-03-23  51.01  110.84  164.940  1495.56  29.17  64.41  164.00   98.540000   \n",
       "2018-03-26  51.86  114.77  172.770  1555.86  30.44  65.80  168.68  100.650000   \n",
       "2018-03-27  50.90  115.01  168.340  1497.05  29.52  65.73  165.54   99.360000   \n",
       "\n",
       "Ticker          F      FB  ...   ORCL     RCL    TSLA    TWX     UA    WFC  \\\n",
       "Date                       ...                                               \n",
       "1962-01-02    NaN     NaN  ...    NaN     NaN     NaN    NaN    NaN    NaN   \n",
       "1962-01-03    NaN     NaN  ...    NaN     NaN     NaN    NaN    NaN    NaN   \n",
       "1962-01-04    NaN     NaN  ...    NaN     NaN     NaN    NaN    NaN    NaN   \n",
       "1962-01-05    NaN     NaN  ...    NaN     NaN     NaN    NaN    NaN    NaN   \n",
       "1962-01-08    NaN     NaN  ...    NaN     NaN     NaN    NaN    NaN    NaN   \n",
       "...           ...     ...  ...    ...     ...     ...    ...    ...    ...   \n",
       "2018-03-21  11.10  169.39  ...  47.02  123.37  316.53  95.29  14.07  54.79   \n",
       "2018-03-22  10.75  164.89  ...  45.89  120.18  309.10  94.26  13.71  52.53   \n",
       "2018-03-23  10.56  159.39  ...  44.79  117.04  301.54  92.57  13.72  50.98   \n",
       "2018-03-26  10.83  160.06  ...  46.48  119.92  304.18  93.99  14.46  52.29   \n",
       "2018-03-27  10.83  152.19  ...  45.38  118.30  279.18  94.20  14.32  51.10   \n",
       "\n",
       "Ticker         WM    WMT    WWE    XOM  \n",
       "Date                                    \n",
       "1962-01-02    NaN    NaN    NaN    NaN  \n",
       "1962-01-03    NaN    NaN    NaN    NaN  \n",
       "1962-01-04    NaN    NaN    NaN    NaN  \n",
       "1962-01-05    NaN    NaN    NaN    NaN  \n",
       "1962-01-08    NaN    NaN    NaN    NaN  \n",
       "...           ...    ...    ...    ...  \n",
       "2018-03-21  85.92  88.18  36.30  75.04  \n",
       "2018-03-22  84.24  87.14  35.90  73.50  \n",
       "2018-03-23  82.90  85.42  35.82  72.89  \n",
       "2018-03-26  84.13  87.50  36.90  74.00  \n",
       "2018-03-27  83.29  86.05  36.18  73.70  \n",
       "\n",
       "[14156 rows x 30 columns]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "concat_pivot(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Date'>"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "concat_pivot(df).pct_change()['AAL'].plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "def compute_pct_change(df):\n",
    "    return df.pct_change()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "````python\n",
    "# CLASSIC WAY TO GATHER AND MANIPULATE DATA \n",
    "\n",
    "df=acquisition()\n",
    "df=concat_pivot(df)\n",
    "df=compute_pct_change(df)\n",
    "````"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```python\n",
    "# CREATING A PIPELINE TO DO SO / RECOMMANDED METHOD\n",
    "\n",
    "acquisition().pipe(concat_pivot).pipe(compute_pct_change)\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "````python\n",
    "# DIFFICULT TO READ METHOD / NOT RECOMMANDED \n",
    "\n",
    "compute_pct_change(concat_pivot(acquisition(), rows='Date', columns='Ticker', values='Adj. Close'))\n",
    "````"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Retrieved 30 tickers\n",
      "Retrieving data for AAPL\n",
      "Retrieving data for NFLX\n",
      "Retrieving data for AMZN\n",
      "Retrieving data for MSFT\n",
      "Retrieving data for GOOG\n",
      "Retrieving data for TSLA\n",
      "Retrieving data for FB\n",
      "Retrieving data for AAP\n",
      "Retrieving data for DIS\n",
      "Retrieving data for NKE\n",
      "Retrieving data for UA\n",
      "Retrieving data for BAC\n",
      "Retrieving data for CCL\n",
      "Retrieving data for CI\n",
      "Retrieving data for AAL\n",
      "Retrieving data for LUV\n",
      "Retrieving data for WFC\n",
      "Retrieving data for WMT\n",
      "Retrieving data for HD\n",
      "Retrieving data for ORCL\n",
      "Retrieving data for IBM\n",
      "Retrieving data for NCLH\n",
      "Retrieving data for RCL\n",
      "Retrieving data for TWX\n",
      "Retrieving data for FOX\n",
      "Retrieving data for F\n",
      "Retrieving data for GCI\n",
      "Retrieving data for XOM\n",
      "Retrieving data for WWE\n",
      "Retrieving data for WM\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Date</th>\n",
       "      <th>1962-01-02</th>\n",
       "      <th>1962-01-03</th>\n",
       "      <th>1962-01-04</th>\n",
       "      <th>1962-01-05</th>\n",
       "      <th>1962-01-08</th>\n",
       "      <th>1962-01-09</th>\n",
       "      <th>1962-01-10</th>\n",
       "      <th>1962-01-11</th>\n",
       "      <th>1962-01-12</th>\n",
       "      <th>1962-01-15</th>\n",
       "      <th>...</th>\n",
       "      <th>2018-03-14</th>\n",
       "      <th>2018-03-15</th>\n",
       "      <th>2018-03-16</th>\n",
       "      <th>2018-03-19</th>\n",
       "      <th>2018-03-20</th>\n",
       "      <th>2018-03-21</th>\n",
       "      <th>2018-03-22</th>\n",
       "      <th>2018-03-23</th>\n",
       "      <th>2018-03-26</th>\n",
       "      <th>2018-03-27</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ticker</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>AAL</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AAP</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1.117583</td>\n",
       "      <td>1.122530</td>\n",
       "      <td>1.105235</td>\n",
       "      <td>1.121384</td>\n",
       "      <td>1.065257</td>\n",
       "      <td>1.130523</td>\n",
       "      <td>1.135538</td>\n",
       "      <td>1.172907</td>\n",
       "      <td>1.213074</td>\n",
       "      <td>1.259528</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AAPL</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.524346</td>\n",
       "      <td>0.525619</td>\n",
       "      <td>0.526365</td>\n",
       "      <td>0.512902</td>\n",
       "      <td>0.533829</td>\n",
       "      <td>0.486203</td>\n",
       "      <td>0.511458</td>\n",
       "      <td>0.488091</td>\n",
       "      <td>0.505359</td>\n",
       "      <td>0.463699</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AMZN</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>7.916162</td>\n",
       "      <td>7.857095</td>\n",
       "      <td>7.828671</td>\n",
       "      <td>7.813063</td>\n",
       "      <td>8.053355</td>\n",
       "      <td>8.236060</td>\n",
       "      <td>8.145074</td>\n",
       "      <td>8.067297</td>\n",
       "      <td>8.005383</td>\n",
       "      <td>7.893014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BAC</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.979799</td>\n",
       "      <td>-0.979713</td>\n",
       "      <td>-0.979531</td>\n",
       "      <td>-0.979300</td>\n",
       "      <td>-0.979843</td>\n",
       "      <td>-0.979853</td>\n",
       "      <td>-0.980215</td>\n",
       "      <td>-0.980496</td>\n",
       "      <td>-0.980435</td>\n",
       "      <td>-0.980281</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CCL</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1.083385</td>\n",
       "      <td>1.078816</td>\n",
       "      <td>1.079888</td>\n",
       "      <td>1.114759</td>\n",
       "      <td>1.121639</td>\n",
       "      <td>1.104173</td>\n",
       "      <td>1.166939</td>\n",
       "      <td>1.208091</td>\n",
       "      <td>1.161629</td>\n",
       "      <td>1.226626</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CI</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1.492234</td>\n",
       "      <td>1.501124</td>\n",
       "      <td>1.520849</td>\n",
       "      <td>1.461038</td>\n",
       "      <td>1.431835</td>\n",
       "      <td>1.491053</td>\n",
       "      <td>1.497583</td>\n",
       "      <td>1.546188</td>\n",
       "      <td>1.563526</td>\n",
       "      <td>1.518485</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DIS</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.377397</td>\n",
       "      <td>-0.381426</td>\n",
       "      <td>-0.390111</td>\n",
       "      <td>-0.390291</td>\n",
       "      <td>-0.385758</td>\n",
       "      <td>-0.390482</td>\n",
       "      <td>-0.391557</td>\n",
       "      <td>-0.399146</td>\n",
       "      <td>-0.403308</td>\n",
       "      <td>-0.399783</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>F</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.893936</td>\n",
       "      <td>-0.892774</td>\n",
       "      <td>-0.891611</td>\n",
       "      <td>-0.891506</td>\n",
       "      <td>-0.891564</td>\n",
       "      <td>-0.890984</td>\n",
       "      <td>-0.893141</td>\n",
       "      <td>-0.892835</td>\n",
       "      <td>-0.892399</td>\n",
       "      <td>-0.891002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FB</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>15.714156</td>\n",
       "      <td>15.608853</td>\n",
       "      <td>15.600000</td>\n",
       "      <td>14.673025</td>\n",
       "      <td>14.300273</td>\n",
       "      <td>14.260360</td>\n",
       "      <td>14.338605</td>\n",
       "      <td>14.093750</td>\n",
       "      <td>13.779317</td>\n",
       "      <td>13.052632</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FOX</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.797872</td>\n",
       "      <td>-0.800392</td>\n",
       "      <td>-0.802150</td>\n",
       "      <td>-0.789928</td>\n",
       "      <td>-0.784835</td>\n",
       "      <td>-0.785702</td>\n",
       "      <td>-0.780581</td>\n",
       "      <td>-0.777590</td>\n",
       "      <td>-0.771461</td>\n",
       "      <td>-0.762928</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GCI</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GOOG</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>29.875369</td>\n",
       "      <td>30.323706</td>\n",
       "      <td>30.013927</td>\n",
       "      <td>29.339862</td>\n",
       "      <td>29.340243</td>\n",
       "      <td>29.051791</td>\n",
       "      <td>27.996130</td>\n",
       "      <td>27.817207</td>\n",
       "      <td>27.791963</td>\n",
       "      <td>26.857539</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HD</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.845662</td>\n",
       "      <td>-0.845100</td>\n",
       "      <td>-0.842427</td>\n",
       "      <td>-0.838974</td>\n",
       "      <td>-0.837698</td>\n",
       "      <td>-0.836811</td>\n",
       "      <td>-0.832911</td>\n",
       "      <td>-0.831827</td>\n",
       "      <td>-0.832531</td>\n",
       "      <td>-0.826206</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IBM</th>\n",
       "      <td>105.890866</td>\n",
       "      <td>105.397078</td>\n",
       "      <td>104.336795</td>\n",
       "      <td>101.907944</td>\n",
       "      <td>100.32616</td>\n",
       "      <td>99.527506</td>\n",
       "      <td>98.749677</td>\n",
       "      <td>96.975897</td>\n",
       "      <td>100.316048</td>\n",
       "      <td>100.765144</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.108731</td>\n",
       "      <td>-0.103667</td>\n",
       "      <td>-0.104493</td>\n",
       "      <td>-0.111519</td>\n",
       "      <td>-0.123260</td>\n",
       "      <td>-0.119818</td>\n",
       "      <td>-0.132352</td>\n",
       "      <td>-0.133353</td>\n",
       "      <td>-0.130457</td>\n",
       "      <td>-0.130353</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LUV</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.622945</td>\n",
       "      <td>-0.624460</td>\n",
       "      <td>-0.619993</td>\n",
       "      <td>-0.614871</td>\n",
       "      <td>-0.611460</td>\n",
       "      <td>-0.631246</td>\n",
       "      <td>-0.625222</td>\n",
       "      <td>-0.619048</td>\n",
       "      <td>-0.624503</td>\n",
       "      <td>-0.626819</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MSFT</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.574136</td>\n",
       "      <td>0.571238</td>\n",
       "      <td>0.553366</td>\n",
       "      <td>0.532838</td>\n",
       "      <td>0.534520</td>\n",
       "      <td>0.600554</td>\n",
       "      <td>0.575263</td>\n",
       "      <td>0.537024</td>\n",
       "      <td>0.628408</td>\n",
       "      <td>0.578232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>NCLH</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.403836</td>\n",
       "      <td>-0.412402</td>\n",
       "      <td>-0.406765</td>\n",
       "      <td>-0.403380</td>\n",
       "      <td>-0.401697</td>\n",
       "      <td>-0.414252</td>\n",
       "      <td>-0.412964</td>\n",
       "      <td>-0.410415</td>\n",
       "      <td>-0.440819</td>\n",
       "      <td>-0.409076</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>NFLX</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>4.747096</td>\n",
       "      <td>4.802132</td>\n",
       "      <td>4.674448</td>\n",
       "      <td>4.656442</td>\n",
       "      <td>4.698134</td>\n",
       "      <td>4.842348</td>\n",
       "      <td>4.818630</td>\n",
       "      <td>4.854864</td>\n",
       "      <td>5.108886</td>\n",
       "      <td>4.687346</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>NKE</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.794122</td>\n",
       "      <td>-0.793236</td>\n",
       "      <td>-0.793029</td>\n",
       "      <td>-0.790385</td>\n",
       "      <td>-0.789606</td>\n",
       "      <td>-0.790350</td>\n",
       "      <td>-0.789958</td>\n",
       "      <td>-0.785240</td>\n",
       "      <td>-0.794287</td>\n",
       "      <td>-0.779939</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORCL</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.209668</td>\n",
       "      <td>-0.211176</td>\n",
       "      <td>-0.206949</td>\n",
       "      <td>-0.209405</td>\n",
       "      <td>-0.295659</td>\n",
       "      <td>-0.291334</td>\n",
       "      <td>-0.287644</td>\n",
       "      <td>-0.306978</td>\n",
       "      <td>-0.294689</td>\n",
       "      <td>-0.314191</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RCL</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.401185</td>\n",
       "      <td>1.380179</td>\n",
       "      <td>1.386646</td>\n",
       "      <td>1.394995</td>\n",
       "      <td>1.653773</td>\n",
       "      <td>1.623777</td>\n",
       "      <td>1.618871</td>\n",
       "      <td>1.613083</td>\n",
       "      <td>1.580034</td>\n",
       "      <td>1.606875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TSLA</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.599936</td>\n",
       "      <td>1.612114</td>\n",
       "      <td>1.575952</td>\n",
       "      <td>1.520174</td>\n",
       "      <td>1.487186</td>\n",
       "      <td>1.565697</td>\n",
       "      <td>1.571975</td>\n",
       "      <td>1.576384</td>\n",
       "      <td>1.536524</td>\n",
       "      <td>1.359932</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TWX</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.704865</td>\n",
       "      <td>-0.702457</td>\n",
       "      <td>-0.700389</td>\n",
       "      <td>-0.696868</td>\n",
       "      <td>-0.693512</td>\n",
       "      <td>-0.698954</td>\n",
       "      <td>-0.695050</td>\n",
       "      <td>-0.693009</td>\n",
       "      <td>-0.691005</td>\n",
       "      <td>-0.662583</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>UA</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.854564</td>\n",
       "      <td>-0.857246</td>\n",
       "      <td>-0.853760</td>\n",
       "      <td>-0.851973</td>\n",
       "      <td>-0.852805</td>\n",
       "      <td>-0.852345</td>\n",
       "      <td>-0.854551</td>\n",
       "      <td>-0.851788</td>\n",
       "      <td>-0.846154</td>\n",
       "      <td>-0.847983</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WFC</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>3.039230</td>\n",
       "      <td>3.109183</td>\n",
       "      <td>2.970170</td>\n",
       "      <td>2.943141</td>\n",
       "      <td>2.918630</td>\n",
       "      <td>2.894101</td>\n",
       "      <td>2.831510</td>\n",
       "      <td>2.715743</td>\n",
       "      <td>2.616183</td>\n",
       "      <td>2.568436</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WM</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.525870</td>\n",
       "      <td>0.517684</td>\n",
       "      <td>0.545438</td>\n",
       "      <td>0.546503</td>\n",
       "      <td>0.571403</td>\n",
       "      <td>0.568169</td>\n",
       "      <td>0.603655</td>\n",
       "      <td>0.626128</td>\n",
       "      <td>0.608912</td>\n",
       "      <td>0.629941</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WMT</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.014582</td>\n",
       "      <td>0.014609</td>\n",
       "      <td>0.032180</td>\n",
       "      <td>0.019231</td>\n",
       "      <td>0.019474</td>\n",
       "      <td>0.026304</td>\n",
       "      <td>0.034425</td>\n",
       "      <td>0.030398</td>\n",
       "      <td>0.040057</td>\n",
       "      <td>0.033137</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WWE</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.574085</td>\n",
       "      <td>-0.576048</td>\n",
       "      <td>-0.585287</td>\n",
       "      <td>-0.582847</td>\n",
       "      <td>-0.585105</td>\n",
       "      <td>-0.588342</td>\n",
       "      <td>-0.588019</td>\n",
       "      <td>-0.580660</td>\n",
       "      <td>-0.578286</td>\n",
       "      <td>-0.579547</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>XOM</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.971077</td>\n",
       "      <td>1.005930</td>\n",
       "      <td>1.031368</td>\n",
       "      <td>1.032621</td>\n",
       "      <td>1.027679</td>\n",
       "      <td>1.067218</td>\n",
       "      <td>1.047354</td>\n",
       "      <td>1.034897</td>\n",
       "      <td>1.005420</td>\n",
       "      <td>1.037037</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>30 rows × 14156 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Date    1962-01-02  1962-01-03  1962-01-04  1962-01-05  1962-01-08  \\\n",
       "Ticker                                                               \n",
       "AAL            NaN         NaN         NaN         NaN         NaN   \n",
       "AAP            NaN         NaN         NaN         NaN         NaN   \n",
       "AAPL           NaN         NaN         NaN         NaN         NaN   \n",
       "AMZN           NaN         NaN         NaN         NaN         NaN   \n",
       "BAC            NaN         NaN         NaN         NaN         NaN   \n",
       "CCL            NaN         NaN         NaN         NaN         NaN   \n",
       "CI             NaN         NaN         NaN         NaN         NaN   \n",
       "DIS            NaN         NaN         NaN         NaN         NaN   \n",
       "F         0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "FB        0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "FOX       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "GCI       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "GOOG      0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "HD        0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "IBM     105.890866  105.397078  104.336795  101.907944   100.32616   \n",
       "LUV       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "MSFT      0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "NCLH      0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "NFLX      0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "NKE       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "ORCL      0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "RCL       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "TSLA      0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "TWX       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "UA        0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "WFC       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "WM        0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "WMT       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "WWE       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "XOM       0.000000    0.000000    0.000000    0.000000     0.00000   \n",
       "\n",
       "Date    1962-01-09  1962-01-10  1962-01-11  1962-01-12  1962-01-15  ...  \\\n",
       "Ticker                                                              ...   \n",
       "AAL            NaN         NaN         NaN         NaN         NaN  ...   \n",
       "AAP            NaN         NaN         NaN         NaN         NaN  ...   \n",
       "AAPL           NaN         NaN         NaN         NaN         NaN  ...   \n",
       "AMZN           NaN         NaN         NaN         NaN         NaN  ...   \n",
       "BAC            NaN         NaN         NaN         NaN         NaN  ...   \n",
       "CCL            NaN         NaN         NaN         NaN         NaN  ...   \n",
       "CI             NaN         NaN         NaN         NaN         NaN  ...   \n",
       "DIS            NaN         NaN         NaN         NaN         NaN  ...   \n",
       "F         0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "FB        0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "FOX       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "GCI       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "GOOG      0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "HD        0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "IBM      99.527506   98.749677   96.975897  100.316048  100.765144  ...   \n",
       "LUV       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "MSFT      0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "NCLH      0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "NFLX      0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "NKE       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "ORCL      0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "RCL       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "TSLA      0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "TWX       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "UA        0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "WFC       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "WM        0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "WMT       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "WWE       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "XOM       0.000000    0.000000    0.000000    0.000000    0.000000  ...   \n",
       "\n",
       "Date    2018-03-14  2018-03-15  2018-03-16  2018-03-19  2018-03-20  \\\n",
       "Ticker                                                               \n",
       "AAL            NaN         NaN         NaN         NaN         NaN   \n",
       "AAP       1.117583    1.122530    1.105235    1.121384    1.065257   \n",
       "AAPL      0.524346    0.525619    0.526365    0.512902    0.533829   \n",
       "AMZN      7.916162    7.857095    7.828671    7.813063    8.053355   \n",
       "BAC      -0.979799   -0.979713   -0.979531   -0.979300   -0.979843   \n",
       "CCL       1.083385    1.078816    1.079888    1.114759    1.121639   \n",
       "CI        1.492234    1.501124    1.520849    1.461038    1.431835   \n",
       "DIS      -0.377397   -0.381426   -0.390111   -0.390291   -0.385758   \n",
       "F        -0.893936   -0.892774   -0.891611   -0.891506   -0.891564   \n",
       "FB       15.714156   15.608853   15.600000   14.673025   14.300273   \n",
       "FOX      -0.797872   -0.800392   -0.802150   -0.789928   -0.784835   \n",
       "GCI       0.000000    0.000000    0.000000    0.000000    0.000000   \n",
       "GOOG     29.875369   30.323706   30.013927   29.339862   29.340243   \n",
       "HD       -0.845662   -0.845100   -0.842427   -0.838974   -0.837698   \n",
       "IBM      -0.108731   -0.103667   -0.104493   -0.111519   -0.123260   \n",
       "LUV      -0.622945   -0.624460   -0.619993   -0.614871   -0.611460   \n",
       "MSFT      0.574136    0.571238    0.553366    0.532838    0.534520   \n",
       "NCLH     -0.403836   -0.412402   -0.406765   -0.403380   -0.401697   \n",
       "NFLX      4.747096    4.802132    4.674448    4.656442    4.698134   \n",
       "NKE      -0.794122   -0.793236   -0.793029   -0.790385   -0.789606   \n",
       "ORCL     -0.209668   -0.211176   -0.206949   -0.209405   -0.295659   \n",
       "RCL       1.401185    1.380179    1.386646    1.394995    1.653773   \n",
       "TSLA      1.599936    1.612114    1.575952    1.520174    1.487186   \n",
       "TWX      -0.704865   -0.702457   -0.700389   -0.696868   -0.693512   \n",
       "UA       -0.854564   -0.857246   -0.853760   -0.851973   -0.852805   \n",
       "WFC       3.039230    3.109183    2.970170    2.943141    2.918630   \n",
       "WM        0.525870    0.517684    0.545438    0.546503    0.571403   \n",
       "WMT       0.014582    0.014609    0.032180    0.019231    0.019474   \n",
       "WWE      -0.574085   -0.576048   -0.585287   -0.582847   -0.585105   \n",
       "XOM       0.971077    1.005930    1.031368    1.032621    1.027679   \n",
       "\n",
       "Date    2018-03-21  2018-03-22  2018-03-23  2018-03-26  2018-03-27  \n",
       "Ticker                                                              \n",
       "AAL            NaN         NaN         NaN         NaN         NaN  \n",
       "AAP       1.130523    1.135538    1.172907    1.213074    1.259528  \n",
       "AAPL      0.486203    0.511458    0.488091    0.505359    0.463699  \n",
       "AMZN      8.236060    8.145074    8.067297    8.005383    7.893014  \n",
       "BAC      -0.979853   -0.980215   -0.980496   -0.980435   -0.980281  \n",
       "CCL       1.104173    1.166939    1.208091    1.161629    1.226626  \n",
       "CI        1.491053    1.497583    1.546188    1.563526    1.518485  \n",
       "DIS      -0.390482   -0.391557   -0.399146   -0.403308   -0.399783  \n",
       "F        -0.890984   -0.893141   -0.892835   -0.892399   -0.891002  \n",
       "FB       14.260360   14.338605   14.093750   13.779317   13.052632  \n",
       "FOX      -0.785702   -0.780581   -0.777590   -0.771461   -0.762928  \n",
       "GCI       0.000000    0.000000    0.000000    0.000000    0.000000  \n",
       "GOOG     29.051791   27.996130   27.817207   27.791963   26.857539  \n",
       "HD       -0.836811   -0.832911   -0.831827   -0.832531   -0.826206  \n",
       "IBM      -0.119818   -0.132352   -0.133353   -0.130457   -0.130353  \n",
       "LUV      -0.631246   -0.625222   -0.619048   -0.624503   -0.626819  \n",
       "MSFT      0.600554    0.575263    0.537024    0.628408    0.578232  \n",
       "NCLH     -0.414252   -0.412964   -0.410415   -0.440819   -0.409076  \n",
       "NFLX      4.842348    4.818630    4.854864    5.108886    4.687346  \n",
       "NKE      -0.790350   -0.789958   -0.785240   -0.794287   -0.779939  \n",
       "ORCL     -0.291334   -0.287644   -0.306978   -0.294689   -0.314191  \n",
       "RCL       1.623777    1.618871    1.613083    1.580034    1.606875  \n",
       "TSLA      1.565697    1.571975    1.576384    1.536524    1.359932  \n",
       "TWX      -0.698954   -0.695050   -0.693009   -0.691005   -0.662583  \n",
       "UA       -0.852345   -0.854551   -0.851788   -0.846154   -0.847983  \n",
       "WFC       2.894101    2.831510    2.715743    2.616183    2.568436  \n",
       "WM        0.568169    0.603655    0.626128    0.608912    0.629941  \n",
       "WMT       0.026304    0.034425    0.030398    0.040057    0.033137  \n",
       "WWE      -0.588342   -0.588019   -0.580660   -0.578286   -0.579547  \n",
       "XOM       1.067218    1.047354    1.034897    1.005420    1.037037  \n",
       "\n",
       "[30 rows x 14156 columns]"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "acquisition().pipe((concat_pivot, 'df'), values='Adj. Close', columns='Date', rows='Ticker').pipe(compute_pct_change)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 2. Error handling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Response [200]>"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import requests as r\n",
    "url='https://s3-eu-west-1.amazonaws.com/ih-materials/uploads/data-static/documents/the-html5-breakfast-site.html'\n",
    "r.get(url)\n",
    "# 200 means it worked fine "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Response [403]>"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url='https://s3-eu-west-1.amazonaws.com/ih-materials/uploads/data-static/documents/forbidden'\n",
    "r.get(url)\n",
    "# 403 means access denied "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [],
   "source": [
    "url='http://google.com'\n",
    "response=r.get(url)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Response [200]>"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<Response [301]>]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response.history\n",
    "# 301 means that the document has moved to another adress / but the original webpage is accessible anyway"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "b'<HTML><HEAD><meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">\\n<TITLE>301 Moved</TITLE></HEAD><BODY>\\n<H1>301 Moved</H1>\\nThe document has moved\\n<A HREF=\"http://www.google.com/\">here</A>.\\r\\n</BODY></HTML>\\r\\n'"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response.history[0].content"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [],
   "source": [
    "response=r.get('http://fb.com')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<Response [301]>, <Response [301]>]"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response.history"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'http://fb.com/'"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response.history[0].url"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'https://fb.com/'"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response.history[1].url"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'https://www.facebook.com/'"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "response.url"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "def func(url, headers={}):\n",
    "    resp=r.get(url,headers=headers)\n",
    "    if resp:\n",
    "        return resp.content\n",
    "    else:\n",
    "        print('Sorry, there is an error:',resp.status_code,'somewhere')\n",
    "        return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "b'<!DOCTYPE html>\\n<html>\\n  <head>\\n    <title>The HTML5 Breakfast Site</title>\\n    <meta charset=\"UTF-8\">\\n\\n    <style>\\n      body {\\n        background-color: limegreen;\\n        margin: 40px;\\n      } \\n    </style>\\n  </head>\\n  <body>\\n    <div id=\"container\">\\n\\n      <nav id=\"topnav\">\\n        <a href=\"https://www.ironhack.com\" target=\"_blank\">HOME</a> |\\n        <a href=\"https://www.ironhack.com/en/team\" target=\"_blank\">ABOUT US</a> |\\n        <a href=\"https://www.ironhack.com/en/contact\" target=\"_blank\">CONTACT US</a>\\n      </nav>\\n\\n      <section id=\"content\">\\n        <h1>The Ironhack Breakfast Place</h1>\\n        <p>Here you will find all sorts of delicious treats</p>\\n        <figure>\\n          <img src=\"breakfast.jpg\" width=\"400\" alt=\"healthy breakfast\">\\n          <figcaption>CC Image courtesy of Ruth Hartnup on Flickr</figcaption>\\n        </figure>\\n      </section>\\n\\n      <footer>\\n        <p class=\"love\">Made with love by Ironhack</p>\\n      </footer>\\n\\n    </div>\\n  </body>\\n</html>\\n'"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "func('https://s3-eu-west-1.amazonaws.com/ih-materials/uploads/data-static/documents/the-html5-breakfast-site.html')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Sorry, there is an error: 403 somewhere\n"
     ]
    }
   ],
   "source": [
    "func('https://s3-eu-west-1.amazonaws.com/ih-materials/uploads/data-static/documents/forbidden')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Types of error that we can meet"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1. Too many redirects \n",
    "2. Timeout Error\n",
    "3. SSL Error\n",
    "4. OS Error \n",
    "5. Rate limitations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "from requests.exceptions import SSLError, Timeout, TooManyRedirects, RequestException\n",
    "from contextlib import closing\n",
    "from IPython.display import Markdown, display\n",
    "import warnings\n",
    "\n",
    "warnings.filterwarnings('ignore')\n",
    "\n",
    "timeout_glob=0.05\n",
    "verify_glob=True\n",
    "allow_glob=False\n",
    "\n",
    "def printmd(string):\n",
    "    display(Markdown('**'+string+'**'))\n",
    "    \n",
    "def is_good_response(x):\n",
    "    \"\"\"\n",
    "    Returns True if the response seems to be an HTML, False otherwise\n",
    "    x is response\n",
    "    \"\"\"\n",
    "    content_type=x.headers['Content-Type'].lower()\n",
    "    return ((x.status_code==200 and content_type is not None and content_type.find('html')>1), x.status_code)\n",
    "\n",
    "def log_error(e):\n",
    "    print(e)\n",
    "    \n",
    "def status_handler(status):\n",
    "    if status<300:\n",
    "        print('Alles gut!')\n",
    "    elif status>=400 and status<500:\n",
    "        print('request has failed due to you mistake bro. Check the link, headers, server and whether you have an access to this page.')\n",
    "    else:\n",
    "        print('Yoooo, I have no clue what has happened. But you are stuck, since you didnt receive any output from server')\n",
    "    return None\n",
    "\n",
    "def adaptive_scraping(url, timeout=timeout_glob, verify=verify_glob):\n",
    "    global timeout_glob\n",
    "    global verify_glob\n",
    "    global allow_glob\n",
    "    import requests as r\n",
    "    try:\n",
    "        with closing(r.get(url, stream=True, timeout=timeout_glob, verify=verify_glob, allow_redirects=allow_glob)) as resp:\n",
    "            test1=is_good_response(resp)\n",
    "            print(resp)\n",
    "            if test1[0]:\n",
    "                return resp.content\n",
    "            else:\n",
    "                return status_handler(test1[1])\n",
    "    except Timeout as e:\n",
    "        log_error(f'Error during request to {url}: {str(e)}')\n",
    "        printmd('We can increase response waiting time. Do you want to continue?')\n",
    "        ans=input('\\n[Yes|No]\\t')\n",
    "        if ans.lower()=='yes':\n",
    "            timeout_glob*=2\n",
    "            return adaptive_scraping(url)\n",
    "        else:\n",
    "            return None\n",
    "    except SSLError as e:\n",
    "        log_error(f'Error during request to {url}: {str(e)}')\n",
    "        printmd('We can skip verification test. Do you want to continue?')\n",
    "        ans=input('\\n[Yes|No]\\t')\n",
    "        if ans.lower()=='yes':\n",
    "            verify_glob=False\n",
    "            return adaptive_scraping(url)\n",
    "        else:\n",
    "            return None\n",
    "    except TooManyRedirects as e:\n",
    "        log_error(f'Error during request to {url}: {str(e)}')\n",
    "        printmd('We can increase the number of allowed redirects. Do you want to continue?')\n",
    "        ans=input('\\n[Yes|No]\\t')\n",
    "        if ans.lower()=='yes':\n",
    "            allow_glob=True\n",
    "            return adaptive_scraping(url)\n",
    "        else:\n",
    "            return None\n",
    "    except RequestException as e:\n",
    "        log_error(f'Error during request to {url}: {str(e)}')\n",
    "        printmd('Unfortunately, we have no clue what to do.  Please try again later. ')\n",
    "        return None\n",
    "        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
